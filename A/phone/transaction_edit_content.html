<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">
    <head>
        <title></title>
        <meta charset="utf-8">
        <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link rel="stylesheet" href="css/fonts/font-awesome.min.css">
        <link rel="stylesheet" href="css/ui-box.css">
        <link rel="stylesheet" href="css/ui-base.css">
        <link rel="stylesheet" href="css/ui-color.css">
        <link rel="stylesheet" href="css/appcan.icon.css">
        <link rel="stylesheet" href="css/appcan.control.css">
        <link rel="stylesheet" href="society_reg_content/css/main.css">
    </head>
    <body class="um-vp bc-bg" ontouchstart>
        <div class="ub ub-ver uinn-a1">
           <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac">
                <div class="ulev-app1 umw4">
                   事务标题：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="漂流" type="text" class="ub-f1" id="title">
                    </div>
                </div>
            </div>
            
          <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    事务状态：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                       <select id="state">
                           <option value="未结束">未结束</option>
                           <option value="已结束">已结束</option>
                       </select>
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    记录人：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="张小三" type="text" class="ub-f1" id="recorder">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    负责人：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="李四" type="text" class="ub-f1" id="director">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    出席人员：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="张三" type="text" class="ub-f1" id="attendance">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    事务日期时间：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="2015-11-15" type="text" class="ub-f1" id="time">
                    </div>
                </div>
            </div>
            
 <!--          <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                  电话：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="18922292506" type="text" class="ub-f1" id="phone">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    部门：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="技术部" type="text" class="ub-f1" id="dept">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    职务：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input placeholder="干部" type="text" class="ub-f1" id="post">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    会费缴交情况：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input type="text" placeholder="2015年已交" class="ub-f1" id="money">
                    </div>
                </div>
            </div>
            
            <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    会员状态：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                       <select id="state">
                           <option value="在册">在册</option>
                           <option value="已毕业">已毕业</option>
                            <option value="已退出">已退出</option>
                       </select>
                    </div>
                </div>
            </div>
            
             <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    入会时间：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input type="text" placeholder="2015-10-10" class="ub-f1" id="addtime">
                    </div>
                </div>
            </div>
            
             <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    毕/退时间：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <input type="text" placeholder="2017-10-10，可空置" class="ub-f1" id="leavetime">
                    </div>
                </div>
            </div>-->
            
             <div class="uba b-gra3 uc-a1 c-wh ub uinn-a7 ub-ac umar-at1">
                <div class="ulev-app1 umw4">
                    事务描述：
                </div>
                <div class="ub ub-ac umh5 ub-f1">
                    <div class="uinput ub ub-f1">
                        <textarea placeholder="事务内容等" class="ub-f1" id="desc"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="ub ub-ver">
                <div class="uinn-at1">
                    <div class="btn ub ub-ac bc-text-head ub-pc bc-btn"  id="submit">
                        确认提交
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script src="js/appcan.js"></script>
    <script src="js/appcan.control.js"></script>
    <script src="js/appcan.listview.js"></script>
    </body>
    <script>
        appcan.ready(function() {
            appcan.initBounce();
            getTransactionDetail();
        })
        function getTransactionDetail() {
            var t_id = appcan.locStorage.getVal("t_id");
            
            var request = appcan.require('request');
       
            request.ajax({
                 type : 'POST',
                  url : appcan.locStorage.getVal("URLBase")+'/transaction_detail.jsp',
                  data : {
                      't_id' : t_id
                  },
                  dataType:"json",
                   success : function (rtn) {
            document.getElementById("title").value = rtn.title;
            document.getElementById("recorder").value = rtn.recorder;
             document.getElementById("time").value = rtn.time.substring(0,10);
            document.getElementById("director").value = rtn.director;
            document.getElementById("attendance").value = rtn.attendance;
            document.getElementById("desc").value = rtn.desc;
            document.getElementById("state").value = rtn.state;                 
          }
        })
     }
        appcan.button("#submit", "ani-act", function() {
            
            var title = document.getElementById("title").value;
            var recorder = document.getElementById("recorder").value;
            var director = document.getElementById("director").value;
            var attendance = document.getElementById("attendance").value;
            var desc = document.getElementById("desc").value;
            var time = document.getElementById("time").value;
            var state = document.getElementById("state").value;
            var t_id = appcan.locStorage.getVal("t_id");
            
             if(title==""||recorder==""||director==""||attendance==""||desc==""||time==""||state==""){
                appcan.window.openToast({
                    msg:'各字段不能为空！',
                    duration:2000
                    });
            }else{

                var request = appcan.require('request');
                request.ajax({
                    type : 'POST',
                    url : appcan.locStorage.getVal("URLBase")+'/transaction_edit.jsp',
                    data : {
                       'title' : title,'recorder' : recorder,'director' : director,'attendance' : attendance,
                        'desc' : desc,'time' : time,'state' : state,'t_id' : t_id
                    },
                    success : function (rtn) {
                      if(rtn=="true"){
                        appcan.window.alert({
                            title : "修改事务信息",
                            content : "修改成功！",
                            buttons : ['确定'],
                            callback : function(err,data,dataType,optId){
                            uexWindow.evaluatePopoverScript("transaction_index","content","listTransaction()");
                            uexWindow.evaluateScript("transaction_add",0,"appcan.window.close(-1)");
                             }
                        });
                      }
                   }
                })
             }
          })                
    </script>
</html>